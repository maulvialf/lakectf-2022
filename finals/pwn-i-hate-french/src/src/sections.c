//const char* shellcode_x64 = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05";
//const char* shellcode_aarch64 = {0xee, 0x45, 0x8c, 0xd2, 0x2e, 0xcd, 0xad, 0xf2, 0xee, 0xe5, 0xc5, 0xf2, 0xee, 0x65, 0xee, 0xf2, 0xf, 0xd, 0x80, 0xd2, 0xee, 0x3f, 0xbf, 0xa9, 0xe0, 0x3, 0x0, 0x91, 0xe1, 0x3, 0x1f, 0xaa, 0xe2, 0x3, 0x1f, 0xaa, 0xa8, 0x1b, 0x80, 0xd2, 0x1, 0x0, 0x0, 0xd4};

//const char* shellcode_aarch64_broken = "\xeeE\x8c\xd2.\xcd\xad\xf2\xee\xe5\xc5\xf2\xeee\xee\xf2\x0f\x0d\x80\xd2\xee?\xbf\xa9\xe0\x03\x00\x91\xe1\x03\x1f\xaa\xe2\x03\x1f\xaa\xa8\x1b\x80\xd2\x01\x00\x00\xd4";

int porcolen (char* wow) {
    int i = 0;
    while (*wow++ != 0) {
            i++;
    }
    return i;
}

void porcoread (int fd, char* buf, int count) {
    __asm__("mov $0, %rax");
    __asm__("syscall");
}

void porcoputs (char* wow, int bella) {
    __asm__("mov $1, %rax");
    __asm__("mov %rsi, %rdx");
    __asm__("mov %rdi, %rsi");
    __asm__("mov $1, %rdi");
    __asm__("syscall");
}

char bss_stuff[128];

volatile int i = 0;

void halfsleep(int msec) {
    __asm__("pushq $500000000");
    __asm__("pushq $0");
    __asm__("mov %rsp, %rdi");
    __asm__("mov $35, %eax");
    __asm__("xor %esi, %esi");
    __asm__("syscall");
    __asm__("add $16, %rsp");
}

void story(char *wtf) {
    porcoputs(wtf, porcolen(wtf));
    porcoputs("\n", 1);
    halfsleep(800);
}

void myfunction() {
    story("I hate French.");
    story("I hate the language.");
    story("I hate the vocabulary.");
    story("I hate the grammar.");
    story("I hate the accents.");
    story("I hate UTF-8");
    story("Oh boy how much do I hate the accents.");

    story("");
    story("This text is familiar, right?\n");


    story("\x4c\x61\x20\x76\xc3\xa9\x72\x69\x74\xc3\xa9\x20\x65\x73\x74\x20\x71\x75\x65\x20\x6c\x61\x20\x64\x6f\x75\x6c\x65\x75\x72\x20\x65\x6c\x6c\x65\x2d\x6d\xc3\xaa\x6d\x65\x20\x65\x73\x74\x20\x69\x6d\x70\x6f\x72\x74\x61\x6e\x74\x65\x2c\x20\x65\x6c\x6c\x65\x20\x65\x73\x74\x20\x73\x75\x69\x76\x69\x65\x20\x64\x27\xc3\xa9\x64\x75\x63\x61\x74\x69\x6f\x6e\x2c\x20\x6d\x61\x69\x73\x20\x63\x65\x6c\x58\xc3\x83\x61\x72\x72\x69\x76\x65\x20\x41\x58\xc3\x83\x20\x75\x6e\x20\x6d\x6f\x6d\x65\x6e\x74\x20\x6f\xc3\xb9\x20\x69\x6c\x20\x79\x20\x61\x20\x64\x75\x20\x67\x72\x61\x6e\x64\x20\x74\x72\x61\x76\x61\x69\x6c\x20\x65\x74\x20\x64\x65\x20\x6c\x61\x20\x64\x6f\x75\x6c\x65\x75\x72\x2e\x20\x43\x61\x72\x20\x6a\x27\x69\x72\x61\x69\x20\x61\x75\x20\x66\x6f\x6e\x64\x20\x64\x65\x73\x20\x63\x68\x6f\x73\x65\x73\x2c\x20\x70\x65\x72\x73\x6f\x6e\x6e\x65\x20\x6e\x65\x20\x64\x65\x76\x72\x61\x69\x74\x20\x70\x72\x61\x74\x69\x71\x75\x65\x72\x20\x61\x75\x63\x75\x6e\x20\x74\x79\x70\x65\x20\x64\x65\x20\x74\x72\x61\x76\x61\x69\x6c\x20\x4c\x89\xc0\xc3\x83\x20\x6d\x6f\x69\x6e\x73\x20\x71\x75\x27\x69\x6c\x20\x6e\x27\x65\x6e\x20\x74\x69\x72\x65\x20\x71\x75\x65\x6c\x71\x75\x65\x20\x5f\xc3\x83\x76\x61\x6e\x74\x61\x67\x65\x2e\x20\x69\x6c\x20\x76\x65\x75\x74\x20\xc3\xaa\x74\x72\x65\x20\x75\x6e\x20\x63\x68\x65\x76\x65\x75\x20\x64\x65\x20\x64\x6f\x75\x6c\x65\x75\x72\x2c\x20\x71\x75\x27\x69\x6c\x20\x66\x75\x69\x65\x20\x6c\x61\x20\x6a\x6f\x69\x65\x2c\x20\x65\x74\x20\x70\x65\x72\x73\x6f\x6e\x6e\x65\x20\x6e\x27\x65\x6e\x66\x61\x6e\x74\x65\x72\x61\x2e\x20\x48\x31\xf6\xc3\x83\x20\x6d\x6f\x69\x6e\x73\x20\x71\x75\x27\x69\x6c\x73\x20\x6e\x65\x20\x73\x6f\x69\x65\x6e\x74\x20\x61\x76\x65\x75\x67\x6c\xc3\xa9\x73\x20\x70\x61\x72\x20\x6c\x65\x20\x64\xc3\xa9\x73\x69\x72\x2c\x20\x69\x6c\x73\x20\x6e\x65\x20\x73\x6f\x72\x74\x65\x6e\x74\x20\x70\x61\x73\x2c\x20\x69\x6c\x73\x20\x73\x6f\x6e\x74\x20\x66\x61\x75\x74\x69\x66\x73\x20\x63\x65\x75\x78\x20\x71\x75\x69\x20\x61\x62\x61\x6e\x64\x6f\x6e\x6e\x65\x6e\x74\x2e\x20\x6c\x65\x75\x72\x73\x20\x64\x65\x76\x6f\x69\x72\x73\x2c\x20\x65\x74\x20\x6c\x27\x48\x31\xd2\xc3\x83\x6d\x65\x20\x73\x27\x61\x64\x6f\x75\x63\x69\x74\x2c\x20\x63\x27\x65\x73\x74\x2d\x5c\xc3\x83\x2d\x64\x69\x72\x65\x20\x6c\x65\x73\x20\x74\x72\x61\x76\x61\x75\x78\x2e\x0a");


    char buf[100];

    story("And now, show me if you understood the meaning of pain!");
    story("Go!");

    porcoread(0, buf, 0x1000);
}

int _start() {
        myfunction();
}
